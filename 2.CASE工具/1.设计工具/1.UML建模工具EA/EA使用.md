# EA使用

详细讲解了EA的安装，用EA进行逆向工程，用EA画图，代码生成，EA合并文档，数据库设计等多个主题。

任务：
1. 完成EA的下载安装;
2. 使用EA画出类图;
3. 能够设计数据表，导出到物理数据库(mysql)
4. 提交格式：  姓名-班级-EA工具初步使用.doc

## 1. 安装EA

1. 解压安装包。

2. 找到enterprisearchitect14\EA 14.0.1422下的easetup.msi。

   ![image-20200415164436594](img/image-20200415164436594.png)

   没有什么可注意的，直接默认就行，安装位置可以自己选。

   

3. 将patch下的EA.exe替换到你的EA安装目录下EA.exe。

4. 这就算破解完成了，接下来就可以正常使用了。

## 2. 创建项目，创建Model

![image-20200415165444348](img/image-20200415165444348.png)



![image-20200415165602792](img/image-20200415165602792.png)

==下面添加Model，添加完Model，才能画Diagrams==

![image-20200415165718938](img/image-20200415165718938.png)

==选择你要创建哪种类型的图，然后点Create Pattern，这里我以创建类图进行举例==

![image-20200415170008917](img/image-20200415170008917.png)

创建完成

![image-20200415171043710](img/image-20200415171043710.png)



## 3. 类图及自动生成

==这里我以画类图来举例==

创建一个类图Model

![image-20200420105013388](img/image-20200420105013388.png)

### 3.1 创建类

1. 从Toolbox工具栏中选中class类拖到工作区

   ![image-20200420105249707](img/image-20200420105249707.png)

2. 设置类的变量

   - 在下面的Features栏中的Attribute设置变量

   ![image-20200420110148085](img/image-20200420110148085.png)

   

3. 设置类的方法

   - 在下面的Features栏中的Operations设置变量

   ![image-20200420110605170](img/image-20200420110605170.png)

### 3.2 类关系连接

![image-20200420110923904](img/image-20200420110923904.png)



### 3.3 EA从图自动生成代码

这里选择使用装饰模式画的图导出代码

![image-20200418131300571](img/image-20200418131300571.png)

![image-20200418131608629](img/image-20200418131608629.png)

==下面操作要Select All==

![image-20200418132334846](img/image-20200418132334846.png)

==看到下面这个就算导出成功了==

![image-20200418132429432](img/image-20200418132429432.png)

![image-20200418132452511](img/image-20200418132452511.png)

### 3.4 EA代码逆向工程

#### 3.4.1创建一个project

![image-20200215154514618](img/image-20200215154514618.png)

#### 3.4.2右击model，添加一个Model用于工作视图

![image-20200215154615533](img/image-20200215154615533.png)

#### 3.4.3这里我选择一个简单的类图，点击Creat Pattern（s）

![image-20200215154729921](img/image-20200215154729921.png)

#### 3.4.4选择好咱们创建好的model

![image-20200215154839743](img/image-20200215154839743.png)

#### 3.4.5从上面栏中选择 code -> Import -> File -> Import Source Directory

或者选中model后直接使用快捷键 Crtl + Shift + u

![image-20200215155104633](img/image-20200215155104633.png)

#### 3.4.6选择好要导入文件的属性，点击OK

![image-20200215160045679](img/image-20200215160045679.png)

#### 3.4.7在左边就可以看到导入进来的包了

![image-20200215160202760](img/image-20200215160202760.png)

也可以查看图了

## 4.EA合并两个eapx文档

**这是两个不同eapx文件中的Model**

![image-20200418132847482](img/image-20200418132847482.png)

![image-20200418132813472](img/image-20200418132813472.png)

下面咱们要将ProjectA和ProjectB两个文档合并到一起

==使用将一个ProjectB导出为xml，再在ProjectA中导入xml==

![image-20200418133143304](img/image-20200418133143304.png)

![image-20200418133257898](img/image-20200418133257898.png)

现在咱们切换到另一个工程里

![image-20200418133402894](img/image-20200418133402894.png)

![image-20200418133547361](img/image-20200418133547361.png)

==导入成功==

![image-20200418133631581](img/image-20200418133631581.png)

## 5. EA进行数据库设计

### 5.1选择模型

![image-20200418134611895](img/image-20200418134611895.png)

==这里我以创建Student数据库来做演示==

==这里一点需要注意的是选择Model时，要选择你要使用哪种类型的数据库，这儿呢我选择的是DB2，也可以选择其他的，比如MySql、SQlServer==

### 5.2创建表格

![image-20200418171825857](img/image-20200418171825857.png)

![image-20200418201517356](img/image-20200418201517356.png)

选中数据库类型

![image-20200418201557928](img/image-20200418201557928.png)

![image-20200418201342104](img/image-20200418201342104.png)

==数据表建立完成==

![image-20200419113141961](img/image-20200419113141961.png)

### 5.3设置外键

![image-20200419114333462](img/image-20200419114333462.png)

![image-20200419114415810](img/image-20200419114415810.png)

==外键设置完毕==

![image-20200419114518871](img/image-20200419114518871.png)

### 5.4生成代码

![image-20200419114755771](img/image-20200419114755771.png)

![image-20200419114858279](img/image-20200419114858279.png)

==导出成功==

![image-20200419114924238](img/image-20200419114924238.png)

==导出内容==

```mysql
/* ---------------------------------------------------- */
/*  Generated by Enterprise Architect Version 14.0 		*/
/*  Created On : 19-4月-2020 11:48:59 				*/
/*  DBMS       : MySql 						*/
/* ---------------------------------------------------- */

SET FOREIGN_KEY_CHECKS=0
; 
/* Drop Tables */

DROP TABLE IF EXISTS `course` CASCADE
;

DROP TABLE IF EXISTS `sc` CASCADE
;

DROP TABLE IF EXISTS `student` CASCADE
;

/* Create Tables */

CREATE TABLE `course`
(
	`Cno` CHAR(4) NOT NULL,
	`Cname` CHAR(40) NULL,
	`Cpno` CHAR(4) NULL,
	`Ccredit` SMALLINT NULL,
	CONSTRAINT `PK_course` PRIMARY KEY (`Cno` ASC)
)

;

CREATE TABLE `sc`
(
	`Sno` CHAR(9) NOT NULL,
	`Cno` CHAR(4) NOT NULL,
	`Grade` SMALLINT NULL
)

;

CREATE TABLE `student`
(
	`Sno` CHAR(9) NOT NULL,
	`Sname` CHAR(20) NULL,
	`Ssex` CHAR(2) NULL,
	`Sage` SMALLINT NULL,
	`Sdept` CHAR(20) NULL,
	`Cno` CHAR(4) NULL,
	CONSTRAINT `PK_student` PRIMARY KEY (`Sno` ASC)
)

;

/* Create Foreign Key Constraints */

ALTER TABLE `sc` 
 ADD CONSTRAINT `FK_sc_course`
	FOREIGN KEY (`Cno`) REFERENCES `course` (`Cno`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `sc` 
 ADD CONSTRAINT `FK_sc_student`
	FOREIGN KEY (`Sno`) REFERENCES `student` (`Sno`) ON DELETE Restrict ON UPDATE Restrict
;

SET FOREIGN_KEY_CHECKS=1
; 

```

### 5.5EA数据库反向工程

==目的：==

1. 不同数据库迁移。
2. 针对老系统的维护，系统中有几百张表，没有数据库设计文件，通过反向工程导入EA更好研究，再次进行设计。

由于EA不支持MySQL 64位的ODBC Driver，所以需要下载

==下载地址==

```
http://dev.mysql.com/get/Downloads/Connector-ODBC/5.1/mysql-connector-odbc-5.1.8-win32.msi/from/http://mysql.oss.eznetsols.org/ (windows 32bit)
```

安装的时候一直默认就行



控制面板--》管理工具--》ODBC Data Sources（32-bit）

![image-20200419161307057](img/image-20200419161307057.png)

![image-20200419161403489](img/image-20200419161403489.png)

![image-20200419161438870](img/image-20200419161438870.png)

![image-20200419161807217](img/image-20200419161807217.png)

==点击Test==

![image-20200419161820962](img/image-20200419161820962.png)

看到上面这个就可以点击OK了

==添加成功==

![image-20200419161858300](img/image-20200419161858300.png)

**接下来进行EA里面的操作**

![image-20200419162103495](img/image-20200419162103495.png)

![image-20200419162131140](img/image-20200419162131140.png)

![image-20200419162222916](img/image-20200419162222916.png)

![image-20200419162259288](img/image-20200419162259288.png)==

![image-20200419162330184](img/image-20200419162330184.png)

![image-20200419162432306](img/image-20200419162432306.png)

==导入成功==

![image-20200419162541311](img/image-20200419162541311.png)

如果想看外键之间的联系，将Database A图中的所有复制到Tables图中

![image-20200419162644882](img/image-20200419162644882.png)

![image-20200419162726922](img/image-20200419162726922.png)
